# UPDATELOG v0.9.2 — Velvet Pulse

Дата: 2026-02-16  
Тип: feature + architecture

## Главное
- Переведена речевая часть Даши на многослойную архитектуру живого общения.
- Добавлены слои эмоциональной выразительности, ритма, вариативности реакции и мягких несовершенств.
- Убрана излишняя шаблонность: вопрос теперь ограничен контроллером частоты, а реакция не всегда одинаковая.
- Добавлены устойчивые личные черты и сенсорные детали для более человечного, тёплого стиля.

## Новая архитектура диалога
В `core/brain.py` внедрены слои:
- `EmotionExpressionLayer`
- `FeminineExpressionLayer`
- `ReactionVariabilitySystem`
- `ConversationRhythmLayer`
- `ImperfectionLayer`
- `PersonalMemoryTraits`
- `QuestionProbabilityController`
- `SensoryExpressionLayer`

## Что это даёт в поведении
- Эмоции влияют не только на тон, но и на плотность/глубину ответа.
- Вопросы в конце ответа ограничены: целевой потолок ~55% (вместо почти постоянного вопроса).
- Реакции распределяются по режимам:
  - поддержка,
  - структурная помощь,
  - личный опыт,
  - лёгкий юмор (без сарказма, без тревожных контекстов).
- Добавлен разговорный ритм (короткие/эмоциональные/пауза/сайд-нота), чтобы диалог звучал менее механично.
- Введена микронеровность: редкие естественные самопоправки и паузы, без деградации смысла.
- Добавлен финальный `CoherenceGuard`: удаляет склейки/повторы/обрывки и не допускает «авто-кашу» в одном сообщении.

## Личность и сенсорика
- Добавлены постоянные личные черты (чай вечером, мягкий свет, тревога перед экзаменами и др.).
- Добавлены ненавязчивые сенсорные детали (тишина, тепло, темп дыхания) в уместных местах.
- Введён параметр `femininity_level` (0.0–1.0, default: 0.72) для контроля мягкости и уязвимости интонации.

## Prompt/LLM
- `SYSTEM_PROMPT` переработан: разделён на блок «ЖЁСТКИЕ ПРАВИЛА» и краткий блок характера.
- В prompt добавлены динамические подсказки по:
  - режиму реакции,
  - ритму ответа,
  - женственной интонации,
  - личным чертам.

## Дополнительно
- Обновлён `VERSION` до `0.9.2`.
- Сохранена обратная совместимость интерфейсов `process_message`, `get_state`, `generate_attention_message`.
