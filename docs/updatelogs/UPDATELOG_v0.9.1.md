# UPDATELOG v0.9.1 ‚Äî Bugfix: Soft Continuity

–î–∞—Ç–∞: 2026-02-15  
–¢–∏–ø: bugfix

## –ì–ª–∞–≤–Ω–æ–µ
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: `job_id`, `polling`, `progress` –∏ –∞–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —á–∞—Ç.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –º—É–∑—ã–∫–∞: —Ç—Ä–µ–∫–∏ —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫ –∏ –Ω–µ –ø—Ä–æ–ø–∞–¥–∞—é—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.
- –ü–æ—á–∏–Ω–µ–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ/–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —É—Å—Ç–æ–π—á–∏–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫.
- –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω composer —á–∞—Ç–∞: –µ–¥–∏–Ω–æ–µ –º–µ–Ω—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –∫–Ω–æ–ø–æ–∫.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–≤—è–∑–∫–∞ "–∫–∞—Ä—Ç–∏–Ω–∫–∞ + —Ç–µ–∫—Å—Ç + –∫–æ–Ω—Ç–µ–∫—Å—Ç" –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –î–∞—à–∏.
- –£—Å–∏–ª–µ–Ω fallback –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ Telegram.
- –£–ª—É—á—à–µ–Ω —Å–ª—É—Ö: –æ—Ç–≤–µ—Ç —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ —ç—Ç–∞–ø–∞–º (–º–µ–ª–æ–¥–∏—è, —Ç–µ–∫—Å—Ç, –æ–±—â–∏–π –≤—ã–≤–æ–¥).

## –ú—É–∑—ã–∫–∞
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:
  - `~/.daria/music_cache` ‚Äî –∫—ç—à/–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏
  - `~/.daria/music_queue.json` ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å
- –ù–æ–≤—ã–π API:
  - `POST /api/music/upload` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–µ–∫–∞ –≤ –∫—ç—à
  - `GET/POST /api/music/queue` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏
  - `GET /api/music/cache/<filename>` ‚Äî –≤—ã–¥–∞—á–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–µ–∫–∞
- `POST /api/music/resolve` —Ç–µ–ø–µ—Ä—å –ø—ã—Ç–∞–µ—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π `play_url`, –µ—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å.
- –í –ø–ª–µ–µ—Ä–µ:
  - –æ—á–µ—Ä–µ–¥—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è/–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è;
  - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö;
  - –¥–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å –æ—à–∏–±–æ–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è.
- –î–ª—è YouTube/Spotify/–Ω–µ–ø—Ä—è–º—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à (`yt-dlp`/`yt_dlp`) —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.

## –ß–∞—Ç UI
- –ö–Ω–æ–ø–∫–∏ `—Å—Ç–∏–∫–µ—Ä—ã/–≤–ª–æ–∂–µ–Ω–∏–µ/—Å—Å—ã–ª–∫–∞` –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –µ–¥–∏–Ω–æ–µ –º–µ–Ω—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤—ë—Ä—Å—Ç–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ `–í—Å–µ/–õ–∏—á–Ω—ã–µ/Telegram` –≤ –ª–µ–≤–æ–π –∫–æ–ª–æ–Ω–∫–µ.
- Drag-over –±–æ–ª—å—à–µ –Ω–µ —Ä–∏—Å—É–µ—Ç –≥—Ä—É–±—É—é –æ–±–ª–∞—Å—Ç—å, –≤–∏–∑—É–∞–ª —Å—Ç–∞–ª –º—è–≥—á–µ.
- –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
- –ü—Ä–µ–≤—å—é –≤–ª–æ–∂–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–æ –≤–ø—Ä–∞–≤–æ.
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –æ–±—ã—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–Ω–µ —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏): —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ —Å "–∑–∞–ª–∏–ø–∞–Ω–∏–µ–º" –º–µ–Ω—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω –µ–¥–∏–Ω—ã–π –∫–ª–∞—Å—Å —Å–∫—Ä—ã—Ç–∏—è `.hidden`).
- –£–ª—É—á—à–µ–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ draw-–∑–∞–ø—Ä–æ—Å–æ–≤ (`–º–æ–∂–µ—à—å –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å`, `—Å–¥–µ–ª–∞–π –∫–∞—Ä—Ç–∏–Ω–∫—É` –∏ –¥—Ä.), —á—Ç–æ–±—ã –ø–ª–∞—à–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ –ø–æ—è–≤–ª—è–ª–∞—Å—å.

## –ö–∞—Ä—Ç–∏–Ω–∫–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –ù–æ–≤—ã–π API —Ñ–æ–Ω–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: `POST /api/images/jobs`, `GET /api/images/jobs/<job_id>`.
- –õ–æ–≥–∏–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ —Å–≤—è–∑–∫—É:
  1. –û—Ç–¥–µ–ª—å–Ω–∞—è vision-–º–æ–¥–µ–ª—å –¥–µ–ª–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ;
  2. –î–∞—à–∞ –ø–æ–ª—É—á–∞–µ—Ç `–∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è + –æ–ø–∏—Å–∞–Ω–∏–µ vision`;
  3. –û—Ç–≤–µ—Ç —Å—Ç—Ä–æ–∏—Ç—Å—è —É–∂–µ –Ω–∞ —ç—Ç–æ–π —Å–≤—è–∑–∫–µ.
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞ –∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö –æ –Ω–µ–π.
- –î–ª—è draw-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω —É—Å—Ç–æ–π—á–∏–≤—ã–π fallback –≤ `api/chat` (model -> abstract).
- –û—Ç–≤–µ—Ç—ã –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–µ –≤ —á–∞—Ç–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º –±–µ–∑ –≤—ã–¥—É–º—ã–≤–∞–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π.

## Telegram
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫: –±–æ—Ç —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã–π image-—Ñ–∞–π–ª, –∞ –Ω–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É.
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–¥—ë—Ç.
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–∫–∏ Telegram `Wrong type of the web page content` (–æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ `InputFile` + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏).

## –°–ª—É—Ö
- –†–∞—Å—à–∏—Ä–µ–Ω –∞—É–¥–∏–æ-–∞–Ω–∞–ª–∏–∑ (tempo, energy, duration, spectral –ø—Ä–∏–∑–Ω–∞–∫–∏, melody_hint).
- –í `/api/senses/hear` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —ç—Ç–∞–ø—ã –∞–Ω–∞–ª–∏–∑–∞ –∏ –±–æ–ª–µ–µ —Å–≤—è–∑–Ω—ã–π –∏—Ç–æ–≥.
- –£–±—Ä–∞–Ω–∞ –ø–µ—Ä–µ—É–≤–µ—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è: –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞–ª–æ, –î–∞—à–∞ —è–≤–Ω–æ –ø–∏—à–µ—Ç –æ–± –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö –∞–Ω–∞–ª–∏–∑–∞.

## Debug
- –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π runtime-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π endpoint: `GET /api/debug/runtime`.
- –û–∫–Ω–æ –ª–æ–≥–æ–≤ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–¥–∫—É –ø—Ä–æ—Ü–µ—Å—Å–∞, –ø–ª–∞–≥–∏–Ω–æ–≤, –ø–æ—Ç–æ–∫–æ–≤, warnings/errors.
- –î–æ–±–∞–≤–ª–µ–Ω—ã request-id –≤ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É `REQ/RES` –∏ —ç—Ç–∞–ø–Ω—ã–µ –ª–æ–≥–∏ —Ü–µ–ø–æ—á–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (`CHAT draw -> IMGJOB_CREATE -> IMGJOB`).

## Patch 2026-02-15 (stability + tracing)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ –∑–∞–ª–∏–ø–∞–Ω–∏—è –º–µ–Ω—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —á–∞—Ç–∞: –¥–æ–±–∞–≤–ª–µ–Ω –∏ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–ª–∞—Å—Å —Å–∫—Ä—ã—Ç–∏—è `.hidden`.
- –£—Å–∏–ª–µ–Ω —Ä–∞–∑–±–æ—Ä draw-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –≤–µ–±-—á–∞—Ç–µ –∏ Telegram (`–º–æ–∂–µ—à—å –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å`, `—Å–¥–µ–ª–∞–π –∫–∞—Ä—Ç–∏–Ω–∫—É` –∏ –¥—Ä.).
- –î–æ–±–∞–≤–ª–µ–Ω —Å–∏—Å—Ç–µ–º–Ω—ã–π notify –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é —Ñ–æ–Ω–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: `üé® –†–∏—Å—É–Ω–æ–∫ –≥–æ—Ç–æ–≤`.
- –í runtime-–æ—Ç–ª–∞–¥–∫—É –¥–æ–±–∞–≤–ª–µ–Ω—ã:
  - –∫–∞—Ä—Ç–∞ –º–æ–¥–µ–ª–µ–π (`chat_llm`, `vision`, `audio_asr`, `image_gen`, `music_analysis`);
  - –ø–æ—Å–ª–µ–¥–Ω–∏–µ image-jobs —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º;
  - –ø–æ—Å–ª–µ–¥–Ω–∏–µ trace-–∑–∞–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.
- –í –ª–æ–≥–∞—Ö backend –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∫–≤–æ–∑–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞:
  - `REQ[...]`/`RES[...]` –¥–ª—è HTTP;
  - `IMGJOB_CREATE[...]` –∏ `IMGJOB[...] start/done/failed` –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω ¬´—Å–ª—É—Ö¬ª:
  - —É–º–µ–Ω—å—à–µ–Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç—è–∂—ë–ª–æ–≥–æ –∞—É–¥–∏–æ-–∞–Ω–∞–ª–∏–∑–∞;
  - ASR-—Ü–µ–ø–æ—á–∫–∞ –≤ `auto` –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è –º–µ–Ω—å—à–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏;
  - –¥–æ–±–∞–≤–ª–µ–Ω –∫—ç—à whisper-–º–æ–¥–µ–ª–∏.
- –ú—É–∑—ã–∫–∞: –¥–ª—è YouTube/Spotify –∏ –ø–æ—Ö–æ–∂–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ —Å–∫–∞—á–∞—Ç—å —Ç—Ä–µ–∫ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à —á–µ—Ä–µ–∑ `yt_dlp/yt-dlp`, –µ—Å–ª–∏ –ø—Ä—è–º–æ–π –ø–æ—Ç–æ–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

## Patch 2026-02-15 (chat + vision + telegram)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ª–æ–∂–Ω—ã–π –∑–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞—Ö –ø—Ä–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
  - draw-—Ç—Ä–∏–≥–≥–µ—Ä –≤ —á–∞—Ç–µ —É–∂–µ—Å—Ç–æ—á—ë–Ω, —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å–ª–æ–≤–∞ `–∫–∞—Ä—Ç–∏–Ω–∫–∞` —Å–∞–º–æ –ø–æ —Å–µ–±–µ –±–æ–ª—å—à–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é.
  - –µ—Å–ª–∏ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É –≤–µ—Ç–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è.
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω UX –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ —á–∞—Ç–µ:
  - –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞-–∑–∞–≥–ª—É—à–∫–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º;
  - –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –∏—Ç–æ–≥–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ü–µ–ø–æ—á–∫–∞ `–∫–∞—Ä—Ç–∏–Ω–∫–∞ + —Ç–µ–∫—Å—Ç`:
  - —Å–Ω–∞—á–∞–ª–∞ –∞–Ω–∞–ª–∏–∑ –º–æ–¥—É–ª–µ–º –∑—Ä–µ–Ω–∏—è;
  - –∑–∞—Ç–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑—Ä–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –î–∞—à–µ;
  - –æ—Ç–≤–µ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø–æ –¥–∞–Ω–Ω—ã–º –∑—Ä–µ–Ω–∏—è –±–µ–∑ –≤—ã–¥—É–º—ã–≤–∞–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π.
- –î–æ–±–∞–≤–ª–µ–Ω–æ —è–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —á–∞—Ç–∞ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–∫–Ω–æ–ø–∫–∞ –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ —á–∞—Ç–∞).
- –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ `black-forest-labs/FLUX.1-schnell` (–≤–∫–ª—é—á–∞—è –º–∏–≥—Ä–∞—Ü–∏—é —Å—Ç–∞—Ä–æ–≥–æ –¥–µ—Ñ–æ–ª—Ç–∞).
- Telegram:
  - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è;
  - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞/–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π;
  - –¥–æ–±–∞–≤–ª–µ–Ω fallback –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–∞–∫ `document`, –µ—Å–ª–∏ `photo` –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è Telegram.
- –û—Ç–ª–∞–¥–∫–∞:
  - WebUI-—Ä–µ–∂–∏–º –ª–æ–≥–æ–≤ –æ—Ç–∫–ª—é—á—ë–Ω –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π;
  - –¥–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π trace-—Ä–µ–∂–∏–º: `python3 main.py --debug --debug-trace`;
  - trace —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `~/.daria/debug-trace.log`.

## Patch 2026-02-15 (vision rewrite + generation flow)
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –∫–æ–Ω—Ç—É—Ä —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
  - –µ–¥–∏–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –¥–ª—è —á–∞—Ç–∞ –∏ —Å–µ–Ω—Å–æ—Ä–æ–≤;
  - —É–ª—É—á—à–µ–Ω–Ω—ã–µ caption-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (`BLIP large/base`, fallback `ViT-GPT2`, fallback –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è);
  - –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç–≤–µ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º —Å—Ç–∏–ª–µ –æ—Ç –ª–∏—Ü–∞ –î–∞—à–∏, –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç `–∫–∞—Ä—Ç–∏–Ω–∫–∞` vs `–Ω–∞—Ä–∏—Å—É–π`:
  - –æ–±—ã—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å –ø—Ä–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–ª—å—à–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é;
  - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ —è–≤–Ω—ã–º draw-–∫–æ–º–∞–Ω–¥–∞–º.
- –ü–µ—Ä–µ–ø–∏—Å–∞–Ω pipeline –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
  - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π prompt –¥–ª—è FLUX —á–µ—Ä–µ–∑ LLM;
  - –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ `diffusers`.
- –£–±—Ä–∞–Ω–∞ ¬´–ª–æ–º–∞—é—â–∞—è¬ª fallback-—Ü–µ–ø–æ—á–∫–∞ –≤ image-jobs (–æ—à–∏–±–∫–∞ `HTTP 530`):
  - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `allow_fallback=false`;
  - –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤–º–µ—Å—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–≥–æ fallback –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∂–∏–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –î–∞—à–∏ –≤ —á–∞—Ç.
- –ß–∞—Ç-UX –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
  - –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞-–∑–∞–≥–ª—É—à–∫–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º;
  - –∞–≤—Ç–æ–∑–∞–º–µ–Ω–∞ –Ω–∞ –∏—Ç–æ–≥–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
  - –ø—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –î–∞—à–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
- Telegram:
  - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ fallback;
  - –ø—Ä–∏ –æ—à–∏–±–∫–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç ¬´–∂–∏–≤—ã–º¬ª —Å–æ–æ–±—â–µ–Ω–∏–µ–º;
  - —É—Å–∏–ª–µ–Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞/–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π.

## Patch 2026-02-15 (hotfix: FLUX startup + vision tone)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `MT5Tokenizer`:
  - –¥–ª—è FLUX –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–π `FluxPipeline` (–±–µ–∑ `AutoPipelineForText2Image`), —á—Ç–æ –æ–±—Ö–æ–¥–∏—Ç –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å `diffusers`/`transformers`.
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–≤—è–∑–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏:
  - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç caption-–º–æ–¥–µ–ª–∏ + fallback caption/classification;
  - –∑–∞—Ç–µ–º –æ—Ç–≤–µ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤ —Å—Ç–∏–ª–µ –î–∞—à–∏ –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–ª–æ–≤ –ø—Ä–æ ¬´–º–æ–¥—É–ª–∏/–º–æ–¥–µ–ª–∏¬ª.
- –£–±—Ä–∞–Ω—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–≤ web/telegram –æ—Å—Ç–∞—é—Ç—Å—è ¬´–∂–∏–≤—ã–µ¬ª –æ—Ç–≤–µ—Ç—ã –æ—Ç –î–∞—à–∏).

## Patch 2026-02-16 (Z-Image + isolated image pipeline)
- –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞ –Ω–∞ `Tongyi-MAI/Z-Image-Turbo`.
- –õ–æ–≥–∏–∫–∞ –∑—Ä–µ–Ω–∏—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å:
  - `web/image_pipeline.py`
  - –≤–Ω—É—Ç—Ä–∏: caption/vision chain, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –æ—Ç–≤–µ—Ç–∞, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ prompt –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ diffusers.
- –í `web/app.py` –æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Ç–æ–Ω–∫–∏–µ –æ–±—ë—Ä—Ç–∫–∏ –∏ –≤—ã–∑–æ–≤—ã –º–æ–¥—É–ª—è, —á—Ç–æ–±—ã —Ç–æ—á–µ—á–Ω–æ –¥–µ–±–∞–∂–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
- –î–ª—è –∑—Ä–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π sanity-check —Å—Ü–µ–Ω—ã —á–µ—Ä–µ–∑ `zero-shot-image-classification`, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –≥—Ä—É–±—ã–µ –ø—Ä–æ–º–∞—Ö–∏ –ø–æ —Ç–∏–ø—É ¬´—Å—É–ø–µ—Ä–≥–µ—Ä–æ–π¬ª –Ω–∞ –∞–Ω–∏–º–µ-–ø–æ—Ä—Ç—Ä–µ—Ç–µ.
- –î–ª—è —Å–µ–Ω—Å–æ—Ä–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ `BLIP-2` –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

## Patch 2026-02-16 (model preloading + GPU memory control)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π (installer/startup):
  - —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∑–∞—Ä–∞–Ω–µ–µ —Å–∫–∞—á–∞—Ç—å –º–æ–¥–µ–ª–∏;
  - –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–µ–ª–µ–π.
- –ö—ç—à –º–æ–¥–µ–ª–µ–π –ø–µ—Ä–µ–≤–µ–¥—ë–Ω –≤ –µ–¥–∏–Ω–æ–µ –º–µ—Å—Ç–æ: `~/.daria/hf-cache` (`HF_HOME`, `TRANSFORMERS_CACHE`, `HUGGINGFACE_HUB_CACHE`).
- –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω –∞–Ω—Ç–∏-OOM –∫–æ–Ω—Ç—É—Ä:
  - `PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True,max_split_size_mb:128`;
  - –æ—á–∏—Å—Ç–∫–∞ VRAM –ø–æ—Å–ª–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞;
  - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –Ω–∞ CPU –ø—Ä–∏ `CUDA out of memory`.
- –î–ª—è –º–Ω–æ–≥–æ–≥–ø—É-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ (`device_map=balanced` + `max_memory`), –¥–ª—è single-GPU –≤–∫–ª—é—á–µ–Ω—ã memory-friendly —Ä–µ–∂–∏–º—ã (`attention_slicing`, `cpu_offload` –∫–æ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ).
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ jobs –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1 worker; 2 –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö GPU), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö OOM.
